# Frontend v0.9.0

**Release Date**: 2025-11-13
**Docker Image**: `financial-agent/frontend:0.9.0`

## Overview

Major UI/UX release adding Alpha Vantage market data visualization, tool wrapper components, and implementing 7 critical code review fixes for improved security, performance, and reliability.

## Features Added

- **Alpha Vantage UI Integration**:
  - Market Movers widget (top gainers/losers with real-time data)
  - News Sentiment visualization component
  - Tool wrapper UI for collapsible market data display
  - Company overview, earnings, and news data rendering
- **Tool Message Wrapper**: Collapsible UI component for tool invocation results
  - Icon-based tool identification
  - Expandable/collapsible sections
  - Formatted data display (tables, charts, lists)
- **Message Pagination UI**: "Load More" button for paginated chat history
  - Loads older messages on demand
  - Smooth prepending of historical messages
  - Automatic scroll management
- **Enhanced Symbol Search**: Improved search with Alpha Vantage symbol lookup
- **Analysis Formatters**: Structured formatters for different market data types

## Bug Fixes & Improvements

### Code Review Fixes (7 total):
- **M1 - Request Deduplication**: React Query mutation keys prevent duplicate API calls
- **M2 - Input Validation**:
  - Empty message rejection
  - 5000 character limit enforcement
  - XSS pattern detection (script tags, javascript: protocol)
  - Whitespace-only message rejection
- **M3 - Rendering Optimization**: useMemo for message list filtering (performance improvement)
- **M4 - Message Pagination**: Frontend UI for loading older messages
- **C1 - Error Recovery**: (Backend only)
- **C2 - Agent Timeout**: (Backend only)
- **C3 - Debug Logging**: (Backend only)

### Additional Improvements:
- Better error boundaries and user feedback
- Improved loading states
- Enhanced type safety with TypeScript
- Better separation of concerns (services, components, hooks)
- Cleaner component structure and reduced prop drilling

## Technical Details

### New Components:
- `ToolWrapper.tsx` - Collapsible tool result wrapper
- `ToolMessageWrapper.tsx` - Chat-specific tool message display
- `MarketMovers.tsx` - Top gainers/losers widget
- `NewsSentimentTool.tsx` - News sentiment visualization
- `analysisFormatters.ts` - Structured data formatters

### New Services:
- `alphaVantageApi.ts` - Alpha Vantage API client
- `analysis.ts` - Analysis API wrapper

### New Types:
- `alphaVantage.ts` - Alpha Vantage data types
- Extended `api.ts` with ToolCall interface and tool_call field

### Hook Updates:
- `useAnalysis.ts`: Added input validation, error recovery, mutation keys
- `useChatRestoration.ts`: Changed to load 50 messages initially (pagination support)

### Component Updates:
- `EnhancedChatInterface.tsx`: Pagination state management
- `ChatMessages.tsx`: Memoized rendering, Load More button
- `ChartPanel.tsx`: Tool wrapper integration
- `SymbolSearch.tsx`: Alpha Vantage symbol search

## Breaking Changes

None - all changes are backward compatible

## Compatibility

| Component | Required Version |
|-----------|-----------------|
| Backend | 0.6.0 |
| React | 18+ |
| TypeScript | 5+ |
| Node.js | 20+ |

## Known Issues

None

## Migration Guide

1. Update backend to v0.6.0 for full feature compatibility
2. Clear browser cache to ensure latest assets are loaded
3. No configuration changes required

## UI/UX Improvements

- **Better Loading States**: Clear indicators for API calls and data loading
- **Improved Error Messages**: User-friendly error messages with actionable guidance
- **Enhanced Data Visualization**: Tables, lists, and formatted displays for market data
- **Responsive Design**: All new components are mobile-friendly
- **Performance**: Memoized components reduce unnecessary re-renders

## Testing

All changes have been manually tested following comprehensive E2E test procedures covering:
- Input validation (empty, long, XSS)
- Message pagination (60+ messages with Load More)
- Request deduplication (rapid clicks)
- Error recovery and user feedback
- Rendering performance
- Alpha Vantage data display
- Tool wrapper functionality
