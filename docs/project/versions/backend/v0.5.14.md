# Backend v0.5.14

**Release Date**: 2025-11-11

## Overview

Critical bug fix for rate limiting middleware crash when Redis is unavailable. This release ensures graceful degradation when Redis connection fails.

## Bug Fixes

- **Rate Limiting Middleware Crash**: Fixed AttributeError when Redis connection fails
  - Issue: SlowAPI middleware crashed with `AttributeError: 'ConnectionError' object has no attribute 'detail'`
  - Root cause: Default exception handler expected only `RateLimitExceeded` exceptions but received `ConnectionError` from Redis failures
  - Fix: Implemented custom exception handler that handles both exception types gracefully
  - Behavior: Returns 503 Service Unavailable when Redis is down instead of 500 Internal Server Error

- **Hardcoded Redis URL**: Fixed hardcoded Redis URL in rate limiter configuration
  - Issue: Rate limiter used hardcoded `redis://redis:6379` instead of reading from settings
  - Impact: Caused connection failures in Kubernetes environments where service is named `redis-service`
  - Fix: Changed to use `settings.redis_url` to respect environment configuration

## Technical Details

### Files Modified
- `backend/src/api/dependencies/rate_limit.py`: Use `settings.redis_url` instead of hardcoded URL
- `backend/src/main.py`: Replaced default `_rate_limit_exceeded_handler` with custom handler that gracefully handles connection errors

### Error Handling Strategy
The new exception handler implements graceful degradation:
1. If rate limit is legitimately exceeded → Return 429 with retry-after header
2. If Redis connection fails → Return 503 and log warning, allowing request monitoring without crashing
