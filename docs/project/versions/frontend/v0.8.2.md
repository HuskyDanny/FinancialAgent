# frontend v0.8.2

**Release Date**: 2025-10-12
**Docker Image**: `financial-agent/frontend:0.8.2`

## Overview

Critical bug fix release addressing auto-scroll behavior during chat streaming that prevented users from reading long AI responses.

## Features Added

None (bug fix release)

## Bug Fixes

### Chat Auto-Scroll Issue
- **Problem**: Chat window auto-scrolled on every streaming token (~60 times/second)
- **Impact**: Users couldn't scroll down to read long assistant responses
- **Root Cause**: `useEffect` dependency on `messages` array triggered on every token update
- **Fix**: Implemented scroll-once pattern using ref-based tracking

### Technical Fix Details

**Before** (Problematic):
```typescript
useEffect(() => {
  // Scrolled on EVERY message change (every streaming token)
  lastUserMessageRef.current?.scrollIntoView({ behavior: "smooth" });
}, [messages, isAnalysisPending]); // ⚠️ Runs constantly during streaming
```

**After** (Fixed):
```typescript
const lastScrolledUserMessageRef = useRef<string | null>(null);

useEffect(() => {
  const lastUserMessage = [...messages].reverse().find(msg => msg.role === "user");
  const userMessageId = lastUserMessage?._id || lastUserMessage?.timestamp;

  // Only scroll if this is a NEW user message (not seen before)
  if (lastScrolledUserMessageRef.current !== userMessageId) {
    lastUserMessageRef.current?.scrollIntoView({ behavior: "smooth" });
    lastScrolledUserMessageRef.current = userMessageId;
  }
  // During streaming: no scroll - user controls
}, [messages]);
```

### Scroll Behavior Timeline
```
User sends message → [Scroll to user message ONCE]
  ↓
Token 1 arrives → [No scroll - user controls]
Token 2 arrives → [No scroll - user controls]
Token 3 arrives → [No scroll - user controls]
  ...
User scrolls down → [Stays where user scrolled]
Response finishes → [No scroll - user controls]
  ↓
User sends another message → [Scroll to new message ONCE]
```

### Performance Impact
- **Before**: ~60 scroll operations per second during streaming
- **After**: 1 scroll operation per user message
- **Improvement**: 60x fewer scroll operations

## Breaking Changes

None

## Compatibility

| Component | Required Version |
|-----------|-----------------|
| Backend | >= 0.5.1 |

## Known Issues

None

## Migration Guide

No migration needed - bug fix is transparent to users.

Users will immediately experience:
1. Ability to scroll freely while AI response is streaming
2. No more forced scrolling back to user message position
3. Better reading experience for multi-paragraph responses
4. Natural scroll behavior consistent with modern chat applications
